<?xml version="1.0" encoding="UTF-8"?>
<repository_context>
  <metadata>
    <chunk_index>{{ ctx.chunk_index }}</chunk_index>
    <total_chunks>{{ ctx.total_chunks }}</total_chunks>
    <files_count>{{ ctx.chunk_files }}</files_count>
    <total_tokens>{{ ctx.total_tokens }}</total_tokens>
    <generated_at>{{ ctx.metadata.generated_at }}</generated_at>
  </metadata>

  <files>
    {% for file in ctx.files %}
    <file path="{{ file.relative_path | xml_escape }}">
      <metadata>
        <is_binary>{{ file.is_binary }}</is_binary>
        <token_count>{{ file.token_count }}</token_count>
        {% if file.lines %}<lines>{{ file.lines }}</lines>{% endif %}
      </metadata>
      {% if not file.is_binary %}
      <content><![CDATA[
{{ file.content }}
      ]]></content>
      {% endif %}
    </file>
    {% endfor %}
  </files>
</repository_context>