{
  "chunk_index": {{ ctx.chunk_index }},
  "total_chunks": {{ ctx.total_chunks }},
  "metadata": {
    "files_in_chunk": {{ ctx.chunk_files }},
    "total_tokens": {{ ctx.total_tokens }},
    "generated_at": "{{ ctx.metadata.generated_at }}",
    "format": "{{ ctx.metadata.format }}"
  },
  "files": [
    {% for file in ctx.files %}
    {
      "path": "{{ file.relative_path }}",
      "is_binary": {{ file.is_binary }},
      "token_count": {{ file.token_count }},
      {% if file.lines %}"lines": {{ file.lines }},{% endif %}
      {% if not file.is_binary %}"content": {{ file.content | json_encode() }}{% else %}"content": null{% endif %}
    }{% if not loop.last %},{% endif %}
    {% endfor %}
  ]
}